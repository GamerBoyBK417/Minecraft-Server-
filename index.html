<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Place an order with CoRamTix Hosting – premium hosting at your fingertips.">
  <title>Place Order – CoRamTix</title>

  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root { --secondary:#674CC4; --primary:#1E40AF; --primary-dark:#1e1b4b; }
    body { font-family: 'Poppins', sans-serif; background-color: #F9FAFB; color: #1F2937; overflow-x: hidden; }
    #preloader { position: fixed; top:0; left:0; width:100%; height:100%; background:#F9FAFB; display:flex; justify-content:center; align-items:center; z-index:9999; transition:opacity .5s ease-out; }
    .loader { border:8px solid #E5E7EB; border-top:8px solid var(--secondary); border-radius:50%; width:60px; height:60px; animation:spin 1s linear infinite; }
    @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
    #content-wrapper { opacity:0; transition:opacity .5s ease-in-out; }
    .nav-link-underline:hover { color: var(--secondary); }
    /* small adjustments for form */
    .submitBtn { transition: background .15s ease; }
    .submitBtn:disabled { opacity: .7; cursor: not-allowed; transform: none; }
  </style>
</head>
<body class="bg-gray-50">

  <!-- Preloader -->
  <div id="preloader"><div class="loader"></div></div>

  <div id="content-wrapper" class="min-h-screen flex flex-col">
    <!-- HEADER -->
    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
      <div class="container mx-auto px-6 py-4 flex justify-between items-center">
        <a href="/" class="flex items-center gap-3">
          <img src="/favicon.svg" alt="CoRamTix Logo" class="h-9 w-9" />
          <span class="text-2xl font-bold text-gray-800">CORAMTIX</span>
        </a>
        <nav class="hidden md:flex items-center space-x-2">
          <a href="/game-hosting" class="text-gray-600 font-medium px-4 py-2 rounded-md nav-link-underline">Game Hosting</a>
          <a href="/bot-hosting" class="text-gray-600 font-medium px-4 py-2 rounded-md nav-link-underline">Bot Hosting</a>
          <a href="/vps-hosting" class="text-gray-600 font-medium px-4 py-2 rounded-md nav-link-underline">VPS Hosting</a>
          <a href="/support" class="text-gray-600 font-medium px-4 py-2 rounded-md nav-link-underline">Support</a>
          <a href="/login" class="ml-4 bg-indigo-600 text-white font-medium px-5 py-2.5 rounded-lg shadow-md hover:bg-indigo-700">Login</a>
        </nav>
        <button id="mobile-menu-btn" class="md:hidden text-gray-700" aria-label="Toggle mobile menu">
          <svg class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/></svg>
        </button>
      </div>

      <div id="mobile-menu" class="hidden md:hidden bg-white px-4 pt-2 pb-4 space-y-2">
        <a href="/game-hosting" class="block text-gray-600 hover:text-indigo-600 font-medium py-2">Game Hosting</a>
        <a href="/bot-hosting" class="block text-gray-600 hover:text-indigo-600 font-medium py-2">Bot Hosting</a>
        <a href="/vps-hosting" class="block text-gray-600 hover:text-indigo-600 font-medium py-2">VPS Hosting</a>
        <a href="/support" class="block text-gray-600 hover:text-indigo-600 font-medium py-2">Support</a>
        <a href="/login" class="block bg-indigo-600 text-white text-center font-medium mt-2 px-5 py-2.5 rounded-lg shadow-md hover:bg-indigo-700">Login</a>
      </div>
    </header>

    <!-- MAIN CONTENT: Order Form -->
    <main class="flex-grow bg-gray-50 py-20">
      <div class="container mx-auto px-6 max-w-2xl">
        <h1 class="text-4xl font-extrabold text-gray-800 text-center mb-6">Place an Order</h1>
        <p class="text-lg text-gray-600 text-center mb-10">Fill the form to order a server or plan. We'll contact you to confirm and activate.</p>

        <form id="orderForm" class="bg-white shadow-lg rounded-xl p-8 space-y-5">
          <!-- HONEYPOT (hidden) -->
          <input type="text" id="honeypot" name="honeypot" style="display:none" autocomplete="off" />

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
            <input type="text" name="name" required class="w-full border-gray-300 rounded-lg px-4 py-3 focus:ring-indigo-500 focus:border-indigo-500"/>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
            <input type="email" name="email" required class="w-full border-gray-300 rounded-lg px-4 py-3 focus:ring-indigo-500 focus:border-indigo-500"/>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Service</label>
            <select name="service" required class="w-full border-gray-300 rounded-lg px-4 py-3 focus:ring-indigo-500 focus:border-indigo-500">
              <option value="">Select a service</option>
              <option value="Game Hosting">Game Hosting</option>
              <option value="Bot Hosting">Bot Hosting</option>
              <option value="VPS Hosting">VPS Hosting</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Plan</label>
            <input type="text" name="plan" placeholder="e.g. 4GB RAM / 2vCPU" required class="w-full border-gray-300 rounded-lg px-4 py-3 focus:ring-indigo-500 focus:border-indigo-500"/>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Additional Notes</label>
            <textarea name="notes" rows="4" placeholder="Anything special you need?" class="w-full border-gray-300 rounded-lg px-4 py-3 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
          </div>

          <div class="flex items-center gap-2">
            <input id="isHuman" type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded" />
            <label for="isHuman" class="text-sm text-gray-700">I am not a robot</label>
          </div>

          <button id="submitBtn" type="submit" class="w-full bg-indigo-600 text-white font-medium px-6 py-3 rounded-lg hover:bg-indigo-700 submitBtn">Submit Order</button>

          <!-- UI messages -->
          <div id="orderStatus" class="text-center text-sm mt-2"></div>
          <div id="cooldownMessage" class="text-center text-sm mt-1 text-gray-600" style="display:none"></div>
        </form>
      </div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-800 text-white">
      <div class="container mx-auto px-6 py-12">
        <nav class="flex justify-center flex-wrap gap-x-6 gap-y-2 mb-8">
          <a href="/terms-of-service" class="text-gray-400 hover:text-white">Terms of service</a>
          <a href="/privacy-policy" class="text-gray-400 hover:text-white">Privacy policy</a>
          <a href="/refund-policy" class="text-gray-400 hover:text-white">Refund policy</a>
        </nav>
        <div class="text-center text-gray-500 border-t border-gray-700 pt-8">
          <p>&copy; <span id="copyright-year"></span> CoRamTix — Premium Server Hosting</p>
        </div>
      </div>
    </footer>
  </div>

  <!-- Inline JS (order.js behavior) -->
  <script>
    // Config
    const API_ENDPOINT = '/.netlify/functions/sendOrder'; // change if needed
    const COOLDOWN_PERIOD_MS = 2 * 24 * 60 * 60 * 1000; // 2 days

    // Elements
    const form = document.getElementById('orderForm');
    const statusMessage = document.getElementById('orderStatus');
    const cooldownMessage = document.getElementById('cooldownMessage');
    const submitBtn = document.getElementById('submitBtn');

    function disableFormUI() {
      if (submitBtn) submitBtn.disabled = true;
      if (!form) return;
      form.querySelectorAll('input, select, textarea, button').forEach(el => { el.disabled = true; });
    }

    function enableFormUI() {
      if (!form) return;
      form.querySelectorAll('input, select, textarea, button').forEach(el => { el.disabled = false; });
    }

    function checkCooldown() {
      try {
        const last = localStorage.getItem('lastOrderSubmission');
        if (!last) return;
        const diff = Date.now() - parseInt(last, 10);
        if (diff < COOLDOWN_PERIOD_MS) {
          const remainingHours = Math.ceil((COOLDOWN_PERIOD_MS - diff) / (1000 * 60 * 60));
          cooldownMessage.textContent = `You can submit another order in approximately ${remainingHours} hours.`;
          cooldownMessage.style.display = 'block';
          disableFormUI();
        }
      } catch (e) {
        console.warn('Cooldown check failed', e);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      // mobile nav toggle
      const btn = document.getElementById('mobile-menu-btn');
      const menu = document.getElementById('mobile-menu');
      if (btn && menu) btn.addEventListener('click', () => menu.classList.toggle('hidden'));

      // copyright year
      const cy = document.getElementById('copyright-year');
      if (cy) cy.textContent = new Date().getFullYear();

      // check cooldown on load
      checkCooldown();

      // form submit
      if (!form) return;
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        // anti-spam
        const honeypot = document.getElementById('honeypot')?.value || '';
        const isHuman = document.getElementById('isHuman')?.checked || false;
        if (honeypot) return; // silent spam reject
        if (!isHuman) {
          statusMessage.textContent = 'Please check the "I am not a robot" box.';
          statusMessage.style.color = 'red';
          return;
        }

        // UI state
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
        statusMessage.textContent = '';
        cooldownMessage.style.display = 'none';

        // collect data (names must match inputs)
        const data = {
          name: form.name.value || '',
          email: form.email.value || '',
          service: form.service.value || '',
          plan: form.plan.value || '',
          notes: form.notes.value || ''
        };

        // basic email check
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(data.email)) {
          statusMessage.textContent = '❌ Please enter a valid email address.';
          statusMessage.style.color = 'red';
          submitBtn.disabled = false;
          submitBtn.textContent = 'Submit Order';
          return;
        }

        try {
          const res = await fetch(API_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
          });

          if (res.ok) {
            statusMessage.textContent = '✅ Order submitted successfully! We will contact you soon.';
            statusMessage.style.color = 'green';
            form.reset();
            localStorage.setItem('lastOrderSubmission', Date.now().toString());
            checkCooldown();
          } else {
            const errText = await res.text().catch(()=> 'Server error');
            statusMessage.textContent = '❌ Failed to submit order. ' + errText;
            statusMessage.style.color = 'red';
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Order';
          }
        } catch (err) {
          console.error(err);
          statusMessage.textContent = '❌ Network error. Please try again.';
          statusMessage.style.color = 'red';
          submitBtn.disabled = false;
          submitBtn.textContent = 'Submit Order';
        }
      });
    });

    // Preloader hide
    window.addEventListener('load', () => {
      const pre = document.getElementById('preloader');
      const content = document.getElementById('content-wrapper');
      if (pre) pre.style.opacity = '0';
      setTimeout(() => { if (pre) pre.style.display = 'none'; if (content) content.style.opacity = '1'; }, 500);
    });
  </script>
</body>
</html>
